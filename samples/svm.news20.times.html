<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Comparing times of gmum.r SVM and e1071 on large data</title>

<script src="http://gmum.net/files/gmum.r/sample/svm.news20.times_files/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="http://gmum.net/files/gmum.r/sample/svm.news20.times_files/bootstrap-3.3.1/css/bootstrap.min.css" rel="stylesheet" />
<script src="http://gmum.net/files/gmum.r/sample/svm.news20.times_files/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="http://gmum.net/files/gmum.r/sample/svm.news20.times_files/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="http://gmum.net/files/gmum.r/sample/svm.news20.times_files/bootstrap-3.3.1/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="http://gmum.net/files/gmum.r/sample/svm.news20.times_files/highlight/default.css"
      type="text/css" />
<script src="http://gmum.net/files/gmum.r/sample/svm.news20.times_files/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">


<div id="header">
<h1 class="title">Comparing times of gmum.r SVM and e1071 on large data</h1>
</div>


<pre class="r"><code>library(gmum.r)
library(caret)
library(e1071)
library(R.utils)</code></pre>
<pre><code>## Loading required package: R.oo
## Loading required package: R.methodsS3
## R.methodsS3 v1.7.0 (2015-02-19) successfully loaded. See ?R.methodsS3 for help.
## R.oo v1.19.0 (2015-02-27) successfully loaded. See ?R.oo for help.
## 
## Attaching package: &#39;R.oo&#39;
## 
## The following object is masked from &#39;package:igraph&#39;:
## 
##     hierarchy
## 
## The following objects are masked from &#39;package:methods&#39;:
## 
##     getClasses, getMethods
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     attach, detach, gc, load, save
## 
## R.utils v2.1.0 (2015-05-27) successfully loaded. See ?R.utils for help.
## 
## Attaching package: &#39;R.utils&#39;
## 
## The following object is masked from &#39;package:igraph&#39;:
## 
##     %&lt;-%
## 
## The following object is masked from &#39;package:utils&#39;:
## 
##     timestamp
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     cat, commandArgs, getOption, inherits, isOpen, parse, warnings</code></pre>
<pre class="r"><code># download news20 dataset
download.file(&quot;http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/binary/news20.binary.bz2&quot;, destfile=&quot;news20.binary.bz2&quot;)
bunzip2(&quot;news20.binary.bz2&quot;)
news20 &lt;- read.matrix.csr(&quot;news20.binary&quot;)
file.remove(&quot;news20.binary&quot;)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>news20.part &lt;- list(y=(news20$y)[1:5000], x=news20$x[1:5000, ])

# acquire data and labels
x &lt;- news20.part$x
y &lt;- news20.part$y

# the dataset has pretty high dimensionality
print(ncol(x))</code></pre>
<pre><code>## [1] 1355191</code></pre>
<pre class="r"><code># prepare vectors for saving evaluation times
lens &lt;- c()
gmum_train_times &lt;- c()
e_train_times &lt;- c()
gmum_test_times &lt;- c()
e_test_times &lt;- c()

# run the main loop
for (p in seq(0.01, 0.3, 0.01)){  
  # partitom the data
  train &lt;- as.integer(createDataPartition(y, p=p, list=FALSE))
  
  # save number of traning examples
  lens &lt;- c(lens, length(train))
  
  # train gmum.r SVM
  train_start &lt;- proc.time()
  gmum_svm &lt;- SVM(x[train],y[train], core=&quot;svmlight&quot;, kernel=&quot;linear&quot;, C=1, gamma=1)
  gmum_train &lt;- as.numeric((proc.time() - train_start)[3])
  
  # calculate gmum.r training time
  gmum_train_times &lt;- c(gmum_train_times, gmum_train)
  
  # train e1071 SVM
  train_start &lt;- proc.time()
  e_svm &lt;- e1071::svm(x=x[train], y=y[train], type=&#39;C-classification&#39;, kernel=&quot;linear&quot;, cost=1, gamma=1, scale=FALSE, fitted=FALSE)
  e_train &lt;- as.numeric((proc.time() - train_start)[3])
  
  # calculate e1071 training time
  e_train_times &lt;- c(e_train_times, e_train)
  
  # test gmum.r SVM
  test_start &lt;- proc.time()
  gmum_pred &lt;- predict(gmum_svm, x[-train])
  gmum_test &lt;- as.numeric((proc.time() - test_start)[3])
  
  # calculate gmum testing
  gmum_test_times &lt;- c(gmum_test_times, gmum_test)
  
  # test e1071
  test_start &lt;- proc.time()
  e_pred &lt;- predict(e_svm, x[-train])
  e_test &lt;- as.numeric((proc.time() - test_start)[3])
  
  # and calculate its testing time
  e_test_times &lt;- c(e_test_times, e_test)
}

# reverse testing data as numbers were decreasing
test_lens &lt;- rep(nrow(x), length(lens)) - lens
gmum_test_times &lt;- rev(gmum_test_times)
e_test_times &lt;- rev(e_test_times)

# preapre data for plotting
library(reshape2)
train_times &lt;- melt(data.frame(x=lens, gmum.r=gmum_train_times, e1071=e_train_times), id=&#39;x&#39;)
test_times &lt;- melt(data.frame(x=test_lens, gmum.r=gmum_test_times, e1071=e_test_times), id=&#39;x&#39;)

# load plotting library
library(ggplot2)

# and use some ggplot2 magic 
ggplot(data=train_times, aes(x=x, y=value, colour=variable)) + 
  geom_line() +
  geom_text(data=train_times[train_times$x==1452,], aes(hjust=1.1, label=variable, colour=variable)) +
  theme(legend.position=&quot;none&quot;) + 
  xlab(&quot;samples number&quot;) +
  ylab(&quot;time&quot;)</code></pre>
<p><img src="http://gmum.net/files/gmum.r/sample/svm.news20.times_files/figure-html/unnamed-chunk-1-1.png" title="" alt="" width="672" /></p>
<pre class="r"><code>ggplot(data=test_times, aes(x=x, y=value, colour=variable)) + 
  geom_line() +
  geom_text(data=test_times[test_times$x==4900,], aes(hjust=1.1, label=variable, colour=variable)) +
  theme(legend.position=&quot;none&quot;) +
  xlab(&quot;samples number&quot;) +
  ylab(&quot;time&quot;)</code></pre>
<p><img src="http://gmum.net/files/gmum.r/sample/svm.news20.times_files/figure-html/unnamed-chunk-1-2.png" title="" alt="" width="672" /></p>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
